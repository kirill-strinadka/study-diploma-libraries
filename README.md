
---

# SlideSync: Набор модулей для управления полиморфными слайдами в веб-приложениях

## Обзор проекта

**SlideSync** — это набор модулей на основе веб-технологий, предназначенный для управления интерактивными полиморфными слайдами в системах онлайн-обучения и презентаций. Он решает проблемы традиционных систем дистанционного обучения, таких как высокая нагрузка на сеть и недостаток удобных инструментов управления слайдами. SlideSync позволяет записывать команды управления слайдами и воспроизводить их синхронно с видео или графикой на стороне клиента, что снижает требования к пропускной способности сети и повышает качество отображения.

Набор модулей разработан с использованием современных веб-технологий (HTML5, JavaScript и DHTML), что обеспечивает совместимость со стандартными браузерами и удобную интеграцию с онлайн-платформами. В отличие от устаревших технологий, таких как Flash, Silverlight или Java-апплеты, SlideSync ориентирован на актуальные стандарты веб-разработки.

**Цель проекта**: создание универсального инструмента для управления полиморфными слайдами, который можно интегрировать в образовательные платформы, обеспечивая запись, воспроизведение и синхронизацию действий с мультимедийными элементами.

---

## Общая архитектура приложения

SlideSync построен на модульной архитектуре с использованием полиморфизма, что обеспечивает гибкость, расширяемость и простоту интеграции. Основные компоненты системы и их роли:

1. **Slide (абстрактный базовый класс)**
    - Задаёт общий интерфейс для всех типов слайдов (растровых, видео и потенциально других).
    - Отвечает за базовую логику записи и воспроизведения команд.

2. **RasterGraphicsSlide и VideoSlide (конкретные реализации слайдов)**
    - Наследуют функциональность от Slide, добавляя специфичную логику для работы с растровой графикой и видео соответственно.
    - Реализуют полиморфизм: один и тот же интерфейс используется для разных типов слайдов.

3. **SlideLibrary (управление слайдами)**
    - Центральный класс для создания, записи и воспроизведения слайдов.
    - Координирует работу с конкретными типами слайдов и их хранением.

4. **SlideStorage (хранилище)**
    - Отвечает за сохранение и извлечение записанных команд слайдов по ключам.

5. **UIManager и ToolManager (управление интерфейсом)**
    - Обеспечивают взаимодействие пользователя с инструментами и контейнерами слайдов.
    - ToolManager создаёт панель инструментов, специфичную для каждого типа слайда.

Эта структура позволяет добавлять новые типы слайдов без изменения основной логики, что делает систему модульной и расширяемой.

---

## Что такое SlideSync и что он позволяет делать?

SlideSync — набор модулей, предоставляющий разработчикам инструменты для создания интерактивных слайдов с возможностью записи и воспроизведения действий. Он позволяет:

- **Создавать слайды разных типов**: растровые (для рисования) и видео (с управлением воспроизведением).
- **Записывать команды**: фиксировать действия пользователя (например, рисование линий или управление видео) с временными метками.
- **Воспроизводить команды**: синхронно выполнять записанные действия на стороне клиента.
- **Интегрировать в веб-приложения**: использовать модули в образовательных платформах для синхронизации слайдов с лекциями.

---

## Техническое описание набора модулей

### Полиморфизм и базовый класс Slide

SlideSync использует полиморфную архитектуру. Все слайды наследуются от абстрактного класса `Slide`, который задаёт общий интерфейс и логику:

- **Назначение Slide**:
    - Обеспечивает единый способ работы с любым типом слайда через абстрактные методы (`render`, `_executeCommand`, `createTools`).
    - Хранит команды в массиве `commands` с временными метками для записи и воспроизведения.

- **Как работают команды**:
    - При вызове метода `startRecording` начинается запись действий с временной меткой относительно начала записи.
    - Команды сохраняются как массивы вида `[время, действие, параметры]`, например, `[1000, "lineTo", [5000, 5000]]`.
    - Метод `play` воспроизводит команды с учётом временных задержек между действиями.

- **Инструменты**:
    - Каждый слайд определяет свои инструменты через метод `createTools`, которые регистрируются в `ToolManager`.
    - Выбранный инструмент влияет на параметры команд (например, цвет или толщина линии для растрового слайда).

- **Хранение и передача**:
    - Команды хранятся в объекте слайда и передаются в `SlideStorage` для сохранения по ключу.
    - Передача возможна через JSON для синхронизации между клиентами.

---

### Описание классов

#### Slide
- **Что делает**: Абстрактный базовый класс для всех слайдов.
- **Для чего нужен**: Задаёт общий интерфейс и логику записи/воспроизведения команд.
- **Ключевые методы**:
    - `startRecording()`: Начинает запись действий.
    - `stopRecording()`: Завершает запись.
    - `play()`: Воспроизводит команды с учётом временных интервалов.
    - `_prepareCommandAndExecute(action, options)`: Формирует и выполняет команду.

#### RasterGraphicsSlide
- **Что делает**: Управляет растровым слайдом для рисования на холсте.
- **Для чего нужен**: Позволяет рисовать линии с настройкой цвета и толщины, записывать и воспроизводить эти действия.


#### VideoSlide
- **Что делает**: Управляет видео-слайдом с функциями воспроизведения, перемотки и изменения скорости.
- **Для чего нужен**: Синхронизирует команды управления видео с временными метками.

#### SlideLibrary
- **Что делает**: Координирует создание, запись и воспроизведение слайдов.
- **Для чего нужен**: Основной класс для работы с набором модулей, предоставляет пользователю API.
- **Ключевые методы**:
    - `createSlide(type, ...args)`: Создаёт слайд заданного типа.
    - `startRecording(key)`: Начинает запись слайда с ключом.
    - `stopRecording()`: Завершает запись и сохраняет команды.
    - `playRecording(key)`: Воспроизводит слайд по ключу.

#### SlideStorage
- **Что делает**: Хранит команды слайдов по ключам.
- **Для чего нужен**: Обеспечивает долговременное хранение и доступ к записанным слайдам.


#### UIManager
- **Что делает**: Управляет контейнерами слайдов и инструментов.
- **Для чего нужен**: Связывает слайды с интерфейсом пользователя.
- **Ключевые методы**:
    - `getToolManager()`: Возвращает менеджер инструментов.
    - `clearUI()`: Очищает интерфейс.

#### ToolManager
- **Что делает**: Создаёт и управляет панелью инструментов.
- **Для чего нужен**: Позволяет динамически добавлять кнопки для управления слайдами.

---

## Как использовать SlideSync?

### Установка
1. Скачайте папку `slide-sync` с GitHub-репозитория проекта.
2. Скопируйте её в ваш проект в директорию, например, `src/modules/slide-sync`.
3. Подключите необходимые модули в вашем JavaScript-коде через импорт.

Доступны такие импорты
```
import { 
    Slide, 
    RasterGraphicsSlide,
    VideoSlide,
    SlideLibrary,
    SlideStorage,
    UIManager,
    ToolManager
} from './slide-sync';
```

---

## Инструкции для пользователя

Чтобы использовать SlideSync в своём проекте:
1. **Скачайте модули**: Загрузите папку `slide-sync` из репозитория.
2. **Импортируйте SlideLibrary**: Это основной класс для работы с системой.
3. **Настройте контейнеры**: Укажите HTML-элементы для слайдов и инструментов.
4. **Создавайте слайды**: Используйте `createSlide` для растровых или видео-слайдов.
5. **Записывайте и воспроизводите**: Управляйте процессом через методы `startRecording`, `stopRecording`, `playRecording`.

---

## Преимущества SlideSync

- **Снижение нагрузки на сеть**: Передаются только команды, а не видео или изображения целиком.
- **Гибкость**: Полиморфная структура позволяет добавлять новые типы слайдов.
- **Интеграция**: Легко встраивается в существующие платформы благодаря веб-технологиям.
- **Интерактивность**: Поддержка записи и воспроизведения действий пользователя.

---

---

## Пример использования SlideSync

В репозитории доступен пример кода, который демонстрирует, как использовать набор модулей SlideSync для создания интерактивного веб-приложения, позволяющего переключаться между растровыми и видео-слайдами, записывать действия пользователя и воспроизводить их. Код представляет собой клиентский скрипт, который интегрирует SlideSync с DOM-элементами HTML-страницы.

---

### Код примера

Код примера представлен в файле `./examples/examples.js`


---

### Описание примера


Этот пример создаёт простое веб-приложение, которое:
1. Позволяет пользователю переключаться между растровым слайдом (с фоновым изображением) и видео-слайдом (с видеофайлом).
2. Предоставляет интерфейс для записи действий пользователя (рисование на растровом слайде или управление видео).
3. Сохраняет записанные команды и создаёт кнопки для их воспроизведения.

#### Как это работает?

1. **Инициализация**:
    - `UIManager` связывает контейнеры слайдов и инструментов с DOM-элементами.
    - `SlideLibrary` используется для создания и управления слайдами.
    - По умолчанию инициализируется растровый слайд с изображением `first-image.jpg`.

2. **Переключение между слайдами**:
    - Кнопки "Растровый слайд" и "Видео-слайд" вызывают функции `initializeRasterSlide` и `initializeVideoSlide`.
    - При переключении очищается интерфейс (`clearUI`), создаётся новый слайд, и обновляется активная кнопка.

3. **Запись действий**:
    - Кнопка "Начать запись" запрашивает у пользователя ключ (название записи) и вызывает `startRecording`.
    - Действия пользователя (например, рисование или управление видео) записываются в массив `commands`.

4. **Остановка записи**:
    - Кнопка "Остановить запись" завершает процесс (`stopRecording`), сохраняет команды и создаёт кнопку воспроизведения.

5. **Воспроизведение**:
    - Кнопки в `playbackButtonsContainer` запускают метод `play` текущего слайда с использованием сохранённых команд.

---

### Пошаговое объяснение по использованию примера

1. **Запуск приложения**:
    - При загрузке страницы отображается растровый слайд с фоном и панель инструментов (цвета и толщина линий).

2. **Переключение слайдов**:
    - Нажмите "Видео-слайд", чтобы переключиться на видео. Появится видеоплеер с кнопками управления (Play, Skip и т.д.).

3. **Запись**:
    - Нажмите "Начать запись", введите название (например, "Демо1"), и начните рисовать на растровом слайде или управлять видео.
    - Все действия (движение мыши, нажатия кнопок) записываются с временными метками.

4. **Остановка и воспроизведение**:
    - Нажмите "Остановить запись". Появится новая кнопка с названием "Воспроизвести: Демо1".
    - Нажмите эту кнопку, и слайд воспроизведёт все записанные действия в том же порядке и с теми же интервалами.

5. **Смена типа слайда**:
    - Переключитесь на другой слайд (например, с растрового на видео). Предыдущие записи очистятся, и процесс начнётся заново.

---

### Технические детали для разработчиков

#### Основные объекты:
- **`uiManager`**: Управляет контейнерами и инструментами.
- **`slideLib`**: Экземпляр `SlideLibrary`, создаёт и управляет слайдами.
- **`currentSlide`**: Указывает на активный слайд (`RasterGraphicsSlide` или `VideoSlide`).

#### Функции:
- **`initializeRasterSlide` и `initializeVideoSlide`**:
    - Очищают интерфейс, создают новый слайд и обновляют состояние кнопок.
- **`setupControls`**:
    - Настраивает обработчики событий для кнопок записи и воспроизведения.
    - Динамически обновляет кнопки воспроизведения в `playbackButtonsContainer`.


---

### Как использовать этот пример?

1. **Установите SlideSync**:
    - Скачайте папку `slide-sync` из репозитория и поместите её в ваш проект (например, в `src/modules/slide-sync`).
    - Переименуйте путь импорта в `import { SlideLibrary, UIManager } from './slide-sync';`.

2. **Добавьте медиафайлы**:
    - Поместите изображение `first-image.jpg` в `examples/img/` и видео `first-video.mp4` в `examples/video/`.

3. **Создайте HTML**:
    - Используйте приведённую выше разметку.

4. **Запустите**:
    - Откройте страницу через локальный сервер (например, с помощью `live-server`), чтобы модули загрузились корректно.

---

